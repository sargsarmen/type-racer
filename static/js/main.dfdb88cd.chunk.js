(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(e,t,n){e.exports=n(44)},43:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"requestStore",function(){return j}),n.d(r,"appStore",function(){return x}),n.d(r,"gameStore",function(){return S}),n.d(r,"loginStore",function(){return k});var a=n(0),c=n.n(a),s=n(15),o=n.n(s),u=n(4),i=n(3),l=n(7),d=n(12),p=n(11),m=n(13),h=n(14),f=n(17),v=n(2),E=n.n(v),b=n(6),g=n(1),y=function(){function e(){var t=this;Object(i.a)(this,e),this.user=null,this.addUser=function(e){t.user=e}}return Object(l.a)(e,[{key:"isAuthenticated",get:function(){return null!==this.user}},{key:"userName",get:function(){return null!==this.user?this.user.name:""}}]),e}();Object(g.h)(y,{user:g.m,isAuthenticated:g.e,addUser:g.d});var x=new y,w=function e(){var t=this;Object(i.a)(this,e),this.start=function(e){t.intervalId&&clearInterval(t.intervalId),t.text=e,t.textSplited=e.split(" ").map(function(e){return{word:e.split("").map(function(e){return{id:Math.random().toString(36).substr(5,12),char:e,isWrong:null}})}}),t.currentText="",t.charIndex=0,t.index=0,t.isStarted=!0,t.isFinished=!1,t.accuracy=0,t.speed=0,t.time=120,t.errorsCount=0,t.totalCount=0,t.startInterval()},this.stop=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.isStarted=!1,clearInterval(t.intervalId),e?t.isFinished=!1:(t.isFinished=!0,D({wpm:t.speed,accuracy:t.accuracy,date:new Date}))},this.calculateMetrics=function(){0===t.errorsCount&&t.totalCount>0?t.accuracy=100:0===t.totalCount?t.accuracy=0:t.accuracy=(100*(t.totalCount-t.errorsCount)/t.totalCount).toFixed(1),t.speed=((t.totalCount/5-t.errorsCount)/((120-t.time)/60)).toFixed(0)},this.startInterval=function(){var e=t;t.intervalId=setInterval(function(){0!==e.time?e.time--:e.stop()},1e3)},this.setNewText=function(e,n){var r=t.textSplited[t.index].word,a=r[t.charIndex],c=r.some(function(e){return e.isWrong});if(function(e){return e>=48&&e<=90||e>=186&&e<=192||e>=219&&e<=222}(n)){if(c&&t.charIndex===r.length)return;t.currentText+=e,a.isWrong=a.char!==e,a.isWrong&&t.errorsCount++,t.charIndex++,t.totalCount++}if(function(e){return 8===e}(n))if(t.currentText=t.currentText.substring(0,t.currentText.length-1),t.charIndex>0)t.charIndex--,r[t.charIndex].isWrong=null;else if(t.index>0){t.index--;var s=t.textSplited[t.index];t.charIndex=s.word.length}(function(e){return 32===e})(n)&&t.charIndex===r.length&&(t.charIndex=0,t.index++,t.textSplited.some(function(e){return e.word.some(function(e){return e.isWrong})})?t.currentText+=" ":t.currentText="",t.totalCount++),t.index===t.textSplited.length-1&&t.charIndex===r.length&&t.stop(),t.calculateMetrics()}};Object(g.h)(w,{text:g.m,textSplited:g.m,currentText:g.m,speed:g.m,accuracy:g.m,time:g.m,isStarted:g.m,isFinished:g.m,start:g.d,stop:g.d});var S=new w,O=function(){function e(){var t=this;Object(i.a)(this,e),this.setRequestInProcess=function(e,n){t.requests.set(e,n)},this.requests=g.m.map({})}return Object(l.a)(e,[{key:"getRequestByType",value:function(e){return this.requests.get(e)}}]),e}();Object(g.h)(O,{requests:g.m,setRequestInProcess:g.d});var j=new O,N=function e(){var t=this;Object(i.a)(this,e),this.init=function(){t.userName="",t.password="",t.error=null},this.addGuestUser=function(e){t.guest=e},this.addUser=function(e){t.user=e},this.onUserNameChanged=function(e){t.userName=e,t.error=null},this.onPasswordChanged=function(e){t.password=e,t.error=null},this.addError=function(e){t.error=e},this.init()};Object(g.h)(N,{userName:g.m,password:g.m,error:g.m,onUserNameChanged:g.d,onPasswordChanged:g.d,addError:g.d});var k=new N,I=n(21),T=function(){var e=Object(b.a)(E.a.mark(function e(t,n){var r,a,c;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Object.assign({headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},n)).body&&"string"!==typeof r.body&&(r.body=JSON.stringify(r.body)),e.next=4,fetch(t,r);case 4:return a=e.sent,e.next=7,a.text();case 7:return c=(c=e.sent)?JSON.parse(c):null,e.abrupt("return",c);case 10:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),C="https://api.myjson.com/bins/",P=function(){function e(){Object(i.a)(this,e),this.errors=[],this.payload=null}return Object(l.a)(e,[{key:"addError",value:function(e){this.errors.push(e)}},{key:"hasError",get:function(){return this.errors.length>0}}]),e}(),R=[{id:"cutec",userName:"user1",password:"qwerty"},{id:"177x90",userName:"user2",password:"qwerty"}],U=function(){var e=Object(b.a)(E.a.mark(function e(t){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j.setRequestInProcess("LOGIN_REQUEST",!0),e.abrupt("return",new Promise(function(e,n){setTimeout(Object(b.a)(E.a.mark(function n(){var r,a,c;return E.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=new P,!(a=R.find(function(e){return e.userName===t.userName&&e.password===t.password}))){n.next=15;break}return n.prev=3,n.next=6,T("".concat(C).concat(a.id),{method:"GET",headers:{}});case 6:(c=n.sent)&&(r.payload=Object(I.a)({id:a.id},c)),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(3),r.addError(n.t0.message);case 13:n.next=16;break;case 15:r.addError("UserName or password is wrong.");case 16:j.setRequestInProcess("LOGIN_REQUEST",!1),e(r);case 18:case"end":return n.stop()}},n,null,[[3,10]])})),500)}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(b.a)(E.a.mark(function e(t){var n,r;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j.setRequestInProcess("LOGIN_REQUEST",!0),n=new P,e.prev=2,e.next=5,T("".concat(C).concat(t),{method:"GET",headers:{}});case 5:(r=e.sent)&&(n.payload=Object(I.a)({id:t},r)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),n.addError(e.t0.message);case 12:return j.setRequestInProcess("LOGIN_REQUEST",!1),e.abrupt("return",n);case 14:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(b.a)(E.a.mark(function e(t){var n,r;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j.setRequestInProcess("SAVE_HISTORY_REQUEST",!0),n=new P,e.prev=2,e.next=5,T("".concat("https://api.myjson.com/bins/").concat(t.id),{method:"PUT",body:t});case 5:(r=e.sent)&&(n.payload=r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),n.addError(e.t0.message);case 12:return j.setRequestInProcess("SAVE_HISTORY_REQUEST",!1),e.abrupt("return",n);case 14:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),_=n(8),L=Object(_.b)(),G=function(){var e=Object(b.a)(E.a.mark(function e(t){var n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(t);case 2:(n=e.sent).hasError?k.addError(n.errors):(localStorage.setItem("token",n.payload.id),x.addUser(n.payload),L.push("/"));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(b.a)(E.a.mark(function e(){var t,n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(j.setRequestInProcess("INIT_APP",!0),!(t=localStorage.getItem("token"))){e.next=7;break}return e.next=5,q(t);case 5:(n=e.sent).hasError||(x.addUser(n.payload),L.push("/"));case 7:j.setRequestInProcess("INIT_APP",!1);case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),W=function(){localStorage.removeItem("token"),x.addUser(null)},D=function(){var e=Object(b.a)(E.a.mark(function e(t){var n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return x.user.history.push(t),e.next=3,A(x.user);case 3:(n=e.sent).hasError||x.addUser(n.payload);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),M=Object(u.b)("appStore")(Object(u.c)(function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(a)))).onLogout=function(e){e.preventDefault(),W()},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.appStore.userName;return c.a.createElement("header",null,c.a.createElement("div",{className:"header-content cont-1120"},c.a.createElement("div",{className:"head-left"},c.a.createElement("h1",null,"TypeRacer")),c.a.createElement("div",{className:"head-center"},c.a.createElement(f.a,{className:"link",to:"/"},"Game"),c.a.createElement(f.a,{className:"link",to:"/history"},"History")),c.a.createElement("div",{className:"head-right"},c.a.createElement("span",{className:"marg-lr-20"},e),c.a.createElement("button",{className:"btn btn-green",onClick:this.onLogout},"Logout"))))}}]),t}(c.a.Component))),Q=function(e){var t=e.children;return c.a.createElement(c.a.Fragment,null,c.a.createElement(M,null),c.a.createElement("main",{className:"cont-1120"},t))},J=function(e){var t=e.children;return c.a.createElement("main",null,t)},B=function(e){var t=e.accuracy,n=e.speed,r=e.onStart;return c.a.createElement("div",{className:"game-result"},c.a.createElement("div",null,c.a.createElement("h3",null,"Game results"),c.a.createElement("p",null,"Accuracy: ".concat(t," %")),c.a.createElement("p",null,"Speed: ".concat(n," wpm"))),c.a.createElement("input",{className:"btn btn-green-border",type:"button",value:"Start new game",onClick:r}))},H=function(e){var t=e.time,n=e.speed,r=e.accuracy,a=e.textSplited,s=e.currentText,o=e.onTyped,u=e.onChange,i=e.onStart;return c.a.createElement("div",null,c.a.createElement("div",{className:"game-info"},c.a.createElement("p",null,"Time: ".concat(t)),c.a.createElement("p",null,"Speed: ".concat(n," wpm")),c.a.createElement("p",null,"Accuracy:  ".concat(r," %"))),c.a.createElement("div",{className:"game-text"},a.map(function(e){return e.word.map(function(t,n){var r="txt",a=t.char;return!0===t.isWrong&&(r="wrong-txt"),!1===t.isWrong&&(r="right-txt"),n===e.word.length-1&&(a+=" "),c.a.createElement("span",{key:t.id,className:r},a)})})),c.a.createElement("div",{className:"game-inp"},c.a.createElement("input",{type:"text",value:s,onKeyUp:o,onChange:u})),c.a.createElement("div",{className:"text-center"},c.a.createElement("input",{className:"btn btn-green-border",type:"button",value:"Restart game",onClick:i})))},V=function(){var e=Object(b.a)(E.a.mark(function e(){var t,n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j.setRequestInProcess("GET_RANDOM_TEXT_REQUEST",!0),t=new P,e.prev=2,e.next=5,T("https://baconipsum.com/api/?type=all-meat&sentences=3",{method:"GET",headers:{}});case 5:(n=e.sent)&&n.length>0&&(t.payload=n.join("")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),t.addError(e.t0.message);case 12:return j.setRequestInProcess("GET_RANDOM_TEXT_REQUEST",!1),e.abrupt("return",t);case 14:case"end":return e.stop()}},e,null,[[2,9]])}));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(b.a)(E.a.mark(function e(){var t;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V();case 2:(t=e.sent).hasError||S.start(t.payload);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Y=Object(u.b)("gameStore")(Object(u.c)(function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(a)))).onStart=function(){X()},n.onTyped=function(e){(0,n.props.gameStore.setNewText)(e.key,e.keyCode)},n.onChange=function(e){},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.gameStore.stop)(!0)}},{key:"componentWillUnmount",value:function(){(0,this.props.gameStore.stop)(!0)}},{key:"render",value:function(){var e=this.props.gameStore,t=e.isStarted,n=e.isFinished,r=e.textSplited,a=e.currentText,s=e.accuracy,o=e.speed,u=e.time;return c.a.createElement("div",{className:"marg-tb-20"},t&&!n&&c.a.createElement(H,{time:u,speed:o,accuracy:s,textSplited:r,currentText:a,onTyped:this.onTyped,onStart:this.onStart,onChange:this.onChange}),!t&&!n&&c.a.createElement("div",{className:"start-game"},c.a.createElement("h3",null,"Improve your typing skills on your own"),c.a.createElement("input",{className:"btn btn-green-border",type:"button",value:"Start game",onClick:this.onStart})),!t&&n&&c.a.createElement(B,{accuracy:s,speed:o,onStart:this.onStart}))}}]),t}(c.a.Component))),K=Object(u.b)("loginStore")(Object(u.c)(function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(a)))).onUserNameChanged=function(e){(0,n.props.loginStore.onUserNameChanged)(e.target.value)},n.onPasswordChanged=function(e){(0,n.props.loginStore.onPasswordChanged)(e.target.value)},n.onLogin=function(){var e=n.props.loginStore,t=e.userName,r=e.password,a=e.addError;t?r?G({userName:t,password:r}):a("Fill Password."):a("Fill UserName.")},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.loginStore.init)()}},{key:"render",value:function(){var e=this.props.loginStore,t=e.error,n=e.userName,r=e.password;return c.a.createElement("div",{className:"login"},c.a.createElement("div",null,c.a.createElement("h1",{className:"marg-b15"},"TypeRacer"),c.a.createElement("div",null,t&&c.a.createElement("span",{className:"eror-text"},t),c.a.createElement("div",{className:"inp-block"},c.a.createElement("input",{type:"text",placeholder:"UserName",value:n,onChange:this.onUserNameChanged})),c.a.createElement("div",{className:"inp-block"},c.a.createElement("input",{type:"password",placeholder:"Password",value:r,onChange:this.onPasswordChanged})),c.a.createElement("div",null,c.a.createElement("input",{className:"btn btn-green",type:"button",value:"Login",disabled:null!==t,onClick:this.onLogin})))))}}]),t}(c.a.Component))),z=Object(u.b)("appStore")(Object(u.c)(function(e){var t=e.appStore.user.history;return c.a.createElement("div",null,c.a.createElement("ul",{className:"history-head"},c.a.createElement("li",null,"Date"),c.a.createElement("li",null,"Accuracy"),c.a.createElement("li",null,"Speed")),t.map(function(e){var t=new Date(e.date);return c.a.createElement("ul",{className:"history-content",key:t.getTime()},c.a.createElement("li",null,t.toLocaleString("en-US")),c.a.createElement("li",null,"".concat(e.accuracy," %")),c.a.createElement("li",null,"".concat(e.wpm," WPM")))}))})),Z=function(e){var t=e.component,n=e.layout,r=e.isPrivate,a=e.isAuthenticated,s=e.isLogin;return c.a.createElement(h.b,{render:function(e){return r&&!a?c.a.createElement(h.a,{to:"/login"}):s&&a?c.a.createElement(h.a,{to:"/"}):c.a.createElement(c.a.Fragment,null,c.a.createElement(n,null,c.a.createElement(t,e)))}})},$=Object(u.b)("appStore","requestStore")(Object(u.c)(function(e){function t(){return Object(i.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){F()}},{key:"render",value:function(){var e=this.props,t=e.appStore,n=e.requestStore.getRequestByType("INIT_APP"),r=t.isAuthenticated;return c.a.createElement(h.c,{history:L},!n&&c.a.createElement(h.d,null,c.a.createElement(Z,{exact:!0,path:"/",component:Y,layout:Q,isPrivate:!0,isAuthenticated:r}),c.a.createElement(Z,{exact:!0,path:"/history",component:z,layout:Q,isPrivate:!0,isAuthenticated:r}),c.a.createElement(Z,{exact:!0,path:"/login",component:K,layout:J,isLogin:!0,isAuthenticated:r})))}}]),t}(c.a.Component))),ee=(n(43),document.getElementById("root"));o.a.render(c.a.createElement(function(){return c.a.createElement(u.a,Object.assign({key:"provider"},r),c.a.createElement($,null))},null),ee)}},[[27,1,2]]]);
//# sourceMappingURL=main.dfdb88cd.chunk.js.map