(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(e,t,n){e.exports=n(44)},43:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"requestStore",function(){return j}),n.d(r,"appStore",function(){return O}),n.d(r,"gameStore",function(){return w}),n.d(r,"loginStore",function(){return k});var a=n(0),s=n.n(a),c=n(15),o=n.n(c),i=n(4),u=n(3),l=n(6),p=n(12),m=n(11),d=n(13),h=n(14),f=n(17),v=n(2),b=n.n(v),E=n(7),g=n(1),y=function(){function e(){var t=this;Object(u.a)(this,e),this.user=null,this.addUser=function(e){t.user=e}}return Object(l.a)(e,[{key:"isAuthenticated",get:function(){return null!==this.user}},{key:"userName",get:function(){return null!==this.user?this.user.name:""}}]),e}();Object(g.h)(y,{user:g.m,isAuthenticated:g.e,addUser:g.d});var O=new y,S=function e(){var t=this;Object(u.a)(this,e),this.start=function(e){t.text=e,t.textSplited=e.split(" ").map(function(e){return{id:Math.random().toString(36).substr(5,12),text:e,isWrong:null}}),t.currentText="",t.index=0,t.isStarted=!0,t.isFinished=!1,t.accuracy=0,t.speed=0,t.time=90,t.numberOfKeystroke=0,t.startInterval()},this.stop=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.isStarted=!1,clearInterval(t.intervalId),e?t.isFinished=!1:(t.isFinished=!0,F({wpm:25,accuracy:54.45,date:new Date}))},this.calculateSpeed=function(){var e=t.textSplited.filter(function(e){return!0===e.isWrong}).length,n=t.textSplited.filter(function(e){return!1===e.isWrong}).length,r=n/(e+n)*100;Number.isNaN(r)?t.speed=0:t.speed=t.numberOfKeystroke/(120-t.time)*r},this.startInterval=function(){var e=t;t.intervalId=setInterval(function(){0!==e.time?e.time--:e.stop()},1e3)},this.setNewText=function(e){t.numberOfKeystroke++;var n=t.textSplited[t.index];n.isWrong=!n.text.startsWith(e.trim()),n.isWrong||n.text.length!==e.length-1||" "!==e[e.length-1]?t.currentText=e:(t.currentText="",t.index++,t.index>=t.textSplited.length&&t.stop(),t.calculateSpeed())}};Object(g.h)(S,{text:g.m,textSplited:g.m,currentText:g.m,speed:g.m,accuracy:g.m,time:g.m,isStarted:g.m,isFinished:g.m,start:g.d,stop:g.d});var w=new S,x=function(){function e(){var t=this;Object(u.a)(this,e),this.setRequestInProcess=function(e,n){t.requests.set(e,n)},this.requests=g.m.map({})}return Object(l.a)(e,[{key:"getRequestByType",value:function(e){return this.requests.get(e)}}]),e}();Object(g.h)(x,{requests:g.m,setRequestInProcess:g.d});var j=new x,N=function e(){var t=this;Object(u.a)(this,e),this.init=function(){t.userName="",t.password="",t.error=null},this.addGuestUser=function(e){t.guest=e},this.addUser=function(e){t.user=e},this.onUserNameChanged=function(e){t.userName=e,t.error=null},this.onPasswordChanged=function(e){t.password=e,t.error=null},this.addError=function(e){t.error=e},this.init()};Object(g.h)(N,{userName:g.m,password:g.m,error:g.m,onUserNameChanged:g.d,onPasswordChanged:g.d,addError:g.d});var k=new N,T=n(21),I=function(){var e=Object(E.a)(b.a.mark(function e(t,n){var r,a,s;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Object.assign({headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},n)).body&&"string"!==typeof r.body&&(r.body=JSON.stringify(r.body)),e.next=4,fetch(t,r);case 4:return a=e.sent,e.next=7,a.text();case 7:return s=(s=e.sent)?JSON.parse(s):null,e.abrupt("return",s);case 10:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),P="https://api.myjson.com/bins/",R=function(){function e(){Object(u.a)(this,e),this.errors=[],this.payload=null}return Object(l.a)(e,[{key:"addError",value:function(e){this.errors.push(e)}},{key:"hasError",get:function(){return this.errors.length>0}}]),e}(),U=[{id:"cutec",userName:"user1",password:"qwerty"},{id:"177x90",userName:"user2",password:"qwerty"}],C=function(){var e=Object(E.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j.setRequestInProcess("LOGIN_REQUEST",!0),e.abrupt("return",new Promise(function(e,n){setTimeout(Object(E.a)(b.a.mark(function n(){var r,a,s;return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=new R,!(a=U.find(function(e){return e.userName===t.userName&&e.password===t.password}))){n.next=15;break}return n.prev=3,n.next=6,I("".concat(P).concat(a.id),{method:"GET",headers:{}});case 6:(s=n.sent)&&(r.payload=Object(T.a)({id:a.id},s)),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(3),r.addError(n.t0.message);case 13:n.next=16;break;case 15:r.addError("UserName or password is wrong.");case 16:j.setRequestInProcess("LOGIN_REQUEST",!1),e(r);case 18:case"end":return n.stop()}},n,null,[[3,10]])})),500)}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(E.a)(b.a.mark(function e(t){var n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j.setRequestInProcess("LOGIN_REQUEST",!0),n=new R,e.prev=2,e.next=5,I("".concat(P).concat(t),{method:"GET",headers:{}});case 5:(r=e.sent)&&(n.payload=Object(T.a)({id:t},r)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),n.addError(e.t0.message);case 12:return j.setRequestInProcess("LOGIN_REQUEST",!1),e.abrupt("return",n);case 14:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(E.a)(b.a.mark(function e(t){var n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j.setRequestInProcess("SAVE_HISTORY_REQUEST",!0),n=new R,e.prev=2,e.next=5,I("".concat("https://api.myjson.com/bins/").concat(t.id),{method:"PUT",body:t});case 5:(r=e.sent)&&(n.payload=r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),n.addError(e.t0.message);case 12:return j.setRequestInProcess("SAVE_HISTORY_REQUEST",!1),e.abrupt("return",n);case 14:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),_=n(8),L=Object(_.b)(),G=function(){var e=Object(E.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t);case 2:(n=e.sent).hasError?k.addError(n.errors):(localStorage.setItem("token",n.payload.id),O.addUser(n.payload),L.push("/"));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(E.a)(b.a.mark(function e(){var t,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(j.setRequestInProcess("INIT_APP",!0),!(t=localStorage.getItem("token"))){e.next=7;break}return e.next=5,q(t);case 5:(n=e.sent).hasError||(O.addUser(n.payload),L.push("/"));case 7:j.setRequestInProcess("INIT_APP",!1);case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),D=function(){localStorage.removeItem("token"),O.addUser(null)},F=function(){var e=Object(E.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return O.user.history.push(t),e.next=3,A(O.user);case 3:(n=e.sent).hasError||O.addUser(n.payload);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Q=Object(i.b)("appStore")(Object(i.c)(function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).onLogout=function(e){e.preventDefault(),D()},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.appStore.userName;return s.a.createElement("header",null,s.a.createElement("div",{className:"header-content cont-1120"},s.a.createElement("div",{className:"head-left"},s.a.createElement("h1",null,"TypeRacer")),s.a.createElement("div",{className:"head-center"},s.a.createElement(f.a,{className:"link",to:"/"},"Game"),s.a.createElement(f.a,{className:"link",to:"/history"},"History")),s.a.createElement("div",{className:"head-right"},s.a.createElement("span",{className:"marg-lr-20"},e),s.a.createElement("button",{className:"btn btn-green",onClick:this.onLogout},"Logout"))))}}]),t}(s.a.Component))),M=function(e){var t=e.children;return s.a.createElement(s.a.Fragment,null,s.a.createElement(Q,null),s.a.createElement("main",{className:"cont-1120"},t))},J=function(e){var t=e.children;return s.a.createElement("main",null,t)},B=function(e){var t=e.accuracy,n=e.speed,r=e.onStart;return s.a.createElement("div",{className:"game-result"},s.a.createElement("div",null,s.a.createElement("h3",null,"Game results"),s.a.createElement("p",null,"Accuracy: ".concat(t," %")),s.a.createElement("p",null,"Speed: ".concat(n," wpm"))),s.a.createElement("input",{className:"btn btn-green-border",type:"button",value:"Start new game",onClick:r}))},H=function(e){var t=e.time,n=e.speed,r=e.textSplited,a=e.currentText,c=e.onTyped,o=e.onStart;return s.a.createElement("div",null,s.a.createElement("div",{className:"game-info"},s.a.createElement("p",null,"Time: ".concat(t)),s.a.createElement("p",null,"Speed: ".concat(n," wpm")),s.a.createElement("p",null,"Accuracy:  ".concat(n," %"))),s.a.createElement("div",{className:"game-text"},r.map(function(e){var t="txt";return!0===e.isWrong&&(t="wrong-txt"),!1===e.isWrong&&(t="right-txt"),s.a.createElement("span",{key:e.id,className:t},"".concat(e.text," "))})),s.a.createElement("div",{className:"game-inp"},s.a.createElement("input",{type:"text",value:a,onChange:c})),s.a.createElement("div",{className:"text-center"},s.a.createElement("input",{className:"btn btn-green-border",type:"button",value:"Restart game",onClick:o})))},K=function(){var e=Object(E.a)(b.a.mark(function e(){var t,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j.setRequestInProcess("GET_RANDOM_TEXT_REQUEST",!0),t=new R,e.prev=2,e.next=5,I("https://baconipsum.com/api/?type=all-meat&sentences=3",{method:"GET",headers:{}});case 5:(n=e.sent)&&n.length>0&&(t.payload=n.join("")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),t.addError(e.t0.message);case 12:return j.setRequestInProcess("GET_RANDOM_TEXT_REQUEST",!1),e.abrupt("return",t);case 14:case"end":return e.stop()}},e,null,[[2,9]])}));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(E.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K();case 2:(t=e.sent).hasError||w.start(t.payload);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),X=Object(i.b)("gameStore")(Object(i.c)(function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).onStart=function(){V()},n.onTyped=function(e){(0,n.props.gameStore.setNewText)(e.target.value)},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.gameStore.stop)(!0)}},{key:"componentWillUnmount",value:function(){(0,this.props.gameStore.stop)(!0)}},{key:"render",value:function(){var e=this.props.gameStore,t=e.isStarted,n=e.isFinished,r=e.textSplited,a=e.currentText,c=e.accuracy,o=e.speed,i=e.time;return s.a.createElement("div",{className:"marg-tb-20"},t&&!n&&s.a.createElement(H,{time:i,speed:o,textSplited:r,currentText:a,onTyped:this.onTyped,onStart:this.onStart}),!t&&!n&&s.a.createElement("div",{className:"start-game"},s.a.createElement("h3",null,"Improve your typing skills on your own"),s.a.createElement("input",{className:"btn btn-green-border",type:"button",value:"Start game",onClick:this.onStart})),!t&&n&&s.a.createElement(B,{accuracy:c,speed:o,onStart:this.onStart}))}}]),t}(s.a.Component))),Y=Object(i.b)("loginStore")(Object(i.c)(function(e){function t(){var e,n;Object(u.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).onUserNameChanged=function(e){(0,n.props.loginStore.onUserNameChanged)(e.target.value)},n.onPasswordChanged=function(e){(0,n.props.loginStore.onPasswordChanged)(e.target.value)},n.onLogin=function(){var e=n.props.loginStore,t=e.userName,r=e.password,a=e.addError;t?r?G({userName:t,password:r}):a("Fill Password."):a("Fill UserName.")},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.loginStore.init)()}},{key:"render",value:function(){var e=this.props.loginStore,t=e.error,n=e.userName,r=e.password;return s.a.createElement("div",{className:"login"},s.a.createElement("div",null,s.a.createElement("h1",{className:"marg-b15"},"TypeRacer"),s.a.createElement("div",null,t&&s.a.createElement("span",{className:"eror-text"},t),s.a.createElement("div",{className:"inp-block"},s.a.createElement("input",{type:"text",placeholder:"UserName",value:n,onChange:this.onUserNameChanged})),s.a.createElement("div",{className:"inp-block"},s.a.createElement("input",{type:"password",placeholder:"Password",value:r,onChange:this.onPasswordChanged})),s.a.createElement("div",null,s.a.createElement("input",{className:"btn btn-green",type:"button",value:"Login",disabled:null!==t,onClick:this.onLogin})))))}}]),t}(s.a.Component))),z=Object(i.b)("appStore")(Object(i.c)(function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.appStore.user.history;return s.a.createElement("div",null,s.a.createElement("ul",{className:"history-head"},s.a.createElement("li",null,"Date"),s.a.createElement("li",null,"Accuracy"),s.a.createElement("li",null,"Speed")),e.map(function(e){var t=new Date(e.date);return s.a.createElement("ul",{className:"history-content",key:t.getTime()},s.a.createElement("li",null,t.toLocaleString("en-US")),s.a.createElement("li",null,"".concat(e.accuracy," %")),s.a.createElement("li",null,"".concat(e.wpm," WPM")))}))}}]),t}(s.a.Component))),Z=function(e){var t=e.component,n=e.layout,r=e.isPrivate,a=e.isAuthenticated,c=e.isLogin;return s.a.createElement(h.b,{render:function(e){return r&&!a?s.a.createElement(h.a,{to:"/login"}):c&&a?s.a.createElement(h.a,{to:"/"}):s.a.createElement(s.a.Fragment,null,s.a.createElement(n,null,s.a.createElement(t,e)))}})},$=Object(i.b)("appStore","requestStore")(Object(i.c)(function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){W()}},{key:"render",value:function(){var e=this.props,t=e.appStore,n=e.requestStore.getRequestByType("INIT_APP"),r=t.isAuthenticated;return s.a.createElement(h.c,{history:L},!n&&s.a.createElement(h.d,null,s.a.createElement(Z,{exact:!0,path:"/",component:X,layout:M,isPrivate:!0,isAuthenticated:r}),s.a.createElement(Z,{exact:!0,path:"/history",component:z,layout:M,isPrivate:!0,isAuthenticated:r}),s.a.createElement(Z,{exact:!0,path:"/login",component:Y,layout:J,isLogin:!0,isAuthenticated:r})))}}]),t}(s.a.Component))),ee=(n(43),document.getElementById("root"));o.a.render(s.a.createElement(function(){return s.a.createElement(i.a,Object.assign({key:"provider"},r),s.a.createElement($,null))},null),ee)}},[[27,1,2]]]);
//# sourceMappingURL=main.905d40f0.chunk.js.map