(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(e,t,n){e.exports=n(44)},43:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"requestStore",function(){return S}),n.d(r,"appStore",function(){return O}),n.d(r,"gameStore",function(){return j}),n.d(r,"loginStore",function(){return k});var a=n(0),c=n.n(a),s=n(15),o=n.n(s),u=n(4),i=n(3),l=n(6),p=n(12),d=n(11),m=n(13),h=n(14),f=n(17),v=n(2),b=n.n(v),E=n(7),g=n(1),y=function(){function e(){var t=this;Object(i.a)(this,e),this.user=null,this.addUser=function(e){t.user=e}}return Object(l.a)(e,[{key:"isAuthenticated",get:function(){return null!==this.user}},{key:"userName",get:function(){return null!==this.user?this.user.name:""}}]),e}();Object(g.h)(y,{user:g.m,isAuthenticated:g.e,addUser:g.d});var O=new y,w=function e(){var t=this;Object(i.a)(this,e),this.start=function(e){t.text=e,t.textSplited=e.split(" ").map(function(e){return{id:Math.random().toString(36).substr(5,12),text:e,isWrong:null}}),t.currentText="",t.index=0,t.isStarted=!0,t.isFinished=!1,t.accuracy=0,t.speed=0,t.time=5,t.numberOfKeystroke=0,t.startInterval()},this.stop=function(){t.isStarted=!1,t.isFinished=!0,clearInterval(t.intervalId),W({wpm:25,accuracy:54.45,date:new Date})},this.calculateSpeed=function(){var e=t.textSplited.filter(function(e){return!0===e.isWrong}).length,n=t.textSplited.filter(function(e){return!1===e.isWrong}).length,r=n/(e+n)*100;t.speed=r!==r?0:t.numberOfKeystroke/(120-t.time)*r},this.startInterval=function(){var e=t;t.intervalId=setInterval(function(){0!==e.time?e.time--:e.stop()},1e3)},this.setNewText=function(e){t.numberOfKeystroke++;var n=t.textSplited[t.index];n.isWrong=!n.text.startsWith(e.trim()),n.isWrong||n.text.length!==e.length-1||" "!==e[e.length-1]?t.currentText=e:(t.currentText="",t.index++,t.index>=t.textSplited.length&&t.stop(),t.calculateSpeed())}};Object(g.h)(w,{text:g.m,textSplited:g.m,currentText:g.m,speed:g.m,accuracy:g.m,time:g.m,isStarted:g.m,isFinished:g.m,start:g.d});var j=new w,x=function(){function e(){var t=this;Object(i.a)(this,e),this.setRequestInProcess=function(e,n){t.requests.set(e,n)},this.requests=g.m.map({})}return Object(l.a)(e,[{key:"getRequestByType",value:function(e){return this.requests.get(e)}}]),e}();Object(g.h)(x,{requests:g.m,setRequestInProcess:g.d});var S=new x,N=function e(){var t=this;Object(i.a)(this,e),this.init=function(){t.userName="",t.password="",t.error=null},this.addGuestUser=function(e){t.guest=e},this.addUser=function(e){t.user=e},this.onUserNameChanged=function(e){t.userName=e,t.error=null},this.onPasswordChanged=function(e){t.password=e,t.error=null},this.addError=function(e){t.error=e},this.init()};Object(g.h)(N,{userName:g.m,password:g.m,error:g.m,onUserNameChanged:g.d,onPasswordChanged:g.d,addError:g.d});var k=new N,T=n(21),I=function(){var e=Object(E.a)(b.a.mark(function e(t,n){var r,a,c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Object.assign({headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},n)).body&&"string"!==typeof r.body&&(r.body=JSON.stringify(r.body)),e.next=4,fetch(t,r);case 4:return a=e.sent,e.next=7,a.text();case 7:return c=(c=e.sent)?JSON.parse(c):null,e.abrupt("return",c);case 10:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),R="https://api.myjson.com/bins/",U=function(){function e(){Object(i.a)(this,e),this.errors=[],this.payload=null}return Object(l.a)(e,[{key:"addError",value:function(e){this.errors.push(e)}},{key:"hasError",get:function(){return this.errors.length>0}}]),e}(),C=[{id:"cutec",userName:"user1",password:"qwerty"},{id:"177x90",userName:"user2",password:"qwerty"}],P=function(){var e=Object(E.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return S.setRequestInProcess("LOGIN_REQUEST",!0),e.abrupt("return",new Promise(function(e,n){setTimeout(Object(E.a)(b.a.mark(function n(){var r,a,c;return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=new U,!(a=C.find(function(e){return e.userName===t.userName&&e.password===t.password}))){n.next=15;break}return n.prev=3,n.next=6,I("".concat(R).concat(a.id),{method:"GET",headers:{}});case 6:(c=n.sent)&&(r.payload=Object(T.a)({id:a.id},c)),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(3),r.addError(n.t0.message);case 13:n.next=16;break;case 15:r.addError("UserName or password is wrong.");case 16:S.setRequestInProcess("LOGIN_REQUEST",!1),e(r);case 18:case"end":return n.stop()}},n,null,[[3,10]])})),500)}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(E.a)(b.a.mark(function e(t){var n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return S.setRequestInProcess("LOGIN_REQUEST",!0),n=new U,e.prev=2,e.next=5,I("".concat(R).concat(t),{method:"GET",headers:{}});case 5:(r=e.sent)&&(n.payload=Object(T.a)({id:t},r)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),n.addError(e.t0.message);case 12:return S.setRequestInProcess("LOGIN_REQUEST",!1),e.abrupt("return",n);case 14:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(E.a)(b.a.mark(function e(t){var n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return S.setRequestInProcess("SAVE_HISTORY_REQUEST",!0),n=new U,e.prev=2,e.next=5,I("".concat("https://api.myjson.com/bins/").concat(t.id),{method:"PUT",body:t});case 5:(r=e.sent)&&(n.payload=r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),n.addError(e.t0.message);case 12:return S.setRequestInProcess("SAVE_HISTORY_REQUEST",!1),e.abrupt("return",n);case 14:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),_=n(8),L=Object(_.a)(),G=function(){var e=Object(E.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t);case 2:(n=e.sent).hasError?k.addError(n.errors):(localStorage.setItem("token",n.payload.id),O.addUser(n.payload),L.push("/"));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(E.a)(b.a.mark(function e(){var t,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("token"))){e.next=6;break}return e.next=4,q(t);case 4:(n=e.sent).hasError||(O.addUser(n.payload),L.push("/"));case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Q=function(){localStorage.removeItem("token"),O.addUser(null)},W=function(){var e=Object(E.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return O.user.history.push(t),e.next=3,A(O.user);case 3:(n=e.sent).hasError||O.addUser(n.payload);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),D=Object(u.b)("appStore")(Object(u.c)(function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(a)))).onLogout=function(e){e.preventDefault(),Q()},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.appStore.userName;return c.a.createElement("header",null,c.a.createElement("div",{className:"header-content cont-1120"},c.a.createElement("div",{className:"head-left"},c.a.createElement("h1",null,"TypeRacer")),c.a.createElement("div",{className:"head-center"},c.a.createElement(f.a,{className:"link",to:"/"},"Game"),c.a.createElement(f.a,{className:"link",to:"/history"},"History")),c.a.createElement("div",{className:"head-right"},c.a.createElement("span",{className:"marg-lr-20"},e),c.a.createElement("button",{className:"btn btn-green",onClick:this.onLogout},"Logout"))))}}]),t}(c.a.Component))),M=function(e){var t=e.children;return c.a.createElement(c.a.Fragment,null,c.a.createElement(D,null),c.a.createElement("main",{className:"cont-1120"},t))},J=function(e){var t=e.children;return c.a.createElement("main",null,t)},H=function(e){var t=e.accuracy,n=e.speed,r=e.onStart;return c.a.createElement("div",null,c.a.createElement("p",null,"Accuracy: ".concat(t," %")),c.a.createElement("p",null,"Speed: ".concat(n," wpm")),c.a.createElement("input",{className:"btn btn-green-border",type:"button",value:"Start new game",onClick:r}))},K=function(e){var t=e.time,n=e.speed,r=e.textSplited,a=e.currentText,s=e.onTyped;return c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement("p",null,"".concat(t)),c.a.createElement("p",null,"".concat(n," wpm"))),c.a.createElement("div",null,r.map(function(e){var t="txt";return!0===e.isWrong&&(t="wrong-txt"),!1===e.isWrong&&(t="right-txt"),c.a.createElement("span",{key:e.id,className:t},"".concat(e.text," "))})),c.a.createElement("div",null,c.a.createElement("input",{type:"text",value:a,onChange:s})))},B=function(){var e=Object(E.a)(b.a.mark(function e(){var t,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return S.setRequestInProcess("GET_RANDOM_TEXT_REQUEST",!0),t=new U,e.prev=2,e.next=5,I("https://baconipsum.com/api/?type=all-meat&sentences=3",{method:"GET",headers:{}});case 5:(n=e.sent)&&n.length>0&&(t.payload=n.join("")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),t.addError(e.t0.message);case 12:return S.setRequestInProcess("GET_RANDOM_TEXT_REQUEST",!1),e.abrupt("return",t);case 14:case"end":return e.stop()}},e,null,[[2,9]])}));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(E.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B();case 2:(t=e.sent).hasError||j.start(t.payload);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),X=Object(u.b)("gameStore")(Object(u.c)(function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(a)))).onStart=function(){V()},n.onTyped=function(e){(0,n.props.gameStore.setNewText)(e.target.value)},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.gameStore,t=e.isStarted,n=e.isFinished,r=e.textSplited,a=e.currentText,s=e.accuracy,o=e.speed,u=e.time;return c.a.createElement("div",{className:"marg-tb-20"},t&&!n&&c.a.createElement(K,{time:u,speed:o,textSplited:r,currentText:a,onTyped:this.onTyped}),!t&&!n&&c.a.createElement("div",null,c.a.createElement("input",{className:"btn btn-green-border",type:"button",value:"Start game",onClick:this.onStart})),!t&&n&&c.a.createElement(H,{accuracy:s,speed:o,onStart:this.onStart}))}}]),t}(c.a.Component))),Y=Object(u.b)("loginStore")(Object(u.c)(function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(a)))).onUserNameChanged=function(e){(0,n.props.loginStore.onUserNameChanged)(e.target.value)},n.onPasswordChanged=function(e){(0,n.props.loginStore.onPasswordChanged)(e.target.value)},n.onLogin=function(){var e=n.props.loginStore,t=e.userName,r=e.password,a=e.addError;t?r?G({userName:t,password:r}):a("Fill Password."):a("Fill UserName.")},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.loginStore.init)()}},{key:"render",value:function(){var e=this.props.loginStore,t=e.error,n=e.userName,r=e.password;return c.a.createElement("div",{className:"login"},c.a.createElement("div",null,c.a.createElement("h1",{className:"marg-b15"},"TypeRacer"),c.a.createElement("div",null,t&&c.a.createElement("span",null,t),c.a.createElement("div",{className:"inp-block"},c.a.createElement("input",{type:"text",placeholder:"UserName",value:n,onChange:this.onUserNameChanged})),c.a.createElement("div",{className:"inp-block"},c.a.createElement("input",{type:"password",placeholder:"Password",value:r,onChange:this.onPasswordChanged})),c.a.createElement("div",null,c.a.createElement("input",{className:"btn btn-green",type:"button",value:"Login",onClick:this.onLogin})))))}}]),t}(c.a.Component))),z=Object(u.b)("appStore")(Object(u.c)(function(e){function t(){return Object(i.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.appStore.user.history;return c.a.createElement("div",null,c.a.createElement("ul",null,c.a.createElement("li",null,"Date"),c.a.createElement("li",null,"Accuracy"),c.a.createElement("li",null,"Speed")),e.map(function(e){return c.a.createElement("ul",null,c.a.createElement("li",null,e.date),c.a.createElement("li",null,e.accuracy),c.a.createElement("li",null,e.wpm))}))}}]),t}(c.a.Component))),Z=function(e){var t=e.component,n=e.layout,r=e.isPrivate,a=e.isAuthenticated,s=e.isLogin;return c.a.createElement(h.b,{render:function(e){return r&&!a?c.a.createElement(h.a,{to:"/login"}):s&&a?c.a.createElement(h.a,{to:"/"}):c.a.createElement(c.a.Fragment,null,c.a.createElement(n,null,c.a.createElement(t,e)))}})},$=Object(u.b)("appStore")(Object(u.c)(function(e){function t(){return Object(i.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){F()}},{key:"render",value:function(){var e=this.props.appStore.isAuthenticated;return c.a.createElement(h.c,{history:L},c.a.createElement(h.d,null,c.a.createElement(Z,{exact:!0,path:"/",component:X,layout:M,isPrivate:!0,isAuthenticated:e}),c.a.createElement(Z,{exact:!0,path:"/history",component:z,layout:M,isPrivate:!0,isAuthenticated:e}),c.a.createElement(Z,{exact:!0,path:"/login",component:Y,layout:J,isLogin:!0,isAuthenticated:e})))}}]),t}(c.a.Component))),ee=(n(43),document.getElementById("root"));o.a.render(c.a.createElement(function(){return c.a.createElement(u.a,Object.assign({key:"provider"},r),c.a.createElement($,null))},null),ee)}},[[27,1,2]]]);
//# sourceMappingURL=main.4ddf07b3.chunk.js.map